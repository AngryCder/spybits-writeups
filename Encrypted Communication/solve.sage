from sage.all import *

p = 12199314399217230433087855084041336884726013066142941473226481166171621644447282501
g = Mod(9323707152679403075093548092112974490092549524343926730794289969401302625355013628,p)

x = Mod(9156451762197305147379609149831704110409014240103113760261222462936302310955878487,p)

y = Mod(12158868547785763687352577251928009415475025295808297692313177200857905535309010524,p)

N = p-1

G = Mod(g,p)

encFlag = 9263689001248219489318988389228127555831239291158924057722242393875963376075754064

X = Mod(6318041508046231279008327999687629007124674337460306414814734797304144687338214030,p)

Y = Mod(9512384367277424083423100263269486878553149722702775402237623884809651748762255461,p)


qi = [p^N.valuation(p) for p in prime_factors(N)]

l = len(qi)
Nqi = [ N/q for q in qi ]
ai = [G^r for r in Nqi ]
bi = [Y^r for r in Nqi ]
yi = [ discrete_log(bi[i],ai[i]) for i in range(l) ]

y = Integer( X ^ crt(yi,qi) )

flag = y.inverse_mod(p) * encFlag % p

print(flag)
